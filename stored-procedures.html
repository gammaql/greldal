<!DOCTYPE html><html lang="id"><head><meta charSet="utf-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><link rel="apple-touch-icon" sizes="57x57" href="/greldal/static/favicons/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/greldal/static/favicons/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/greldal/static/favicons/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/greldal/static/favicons/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/greldal/static/favicons/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/greldal/static/favicons/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/greldal/static/favicons/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/greldal/static/favicons/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/greldal/static/favicons/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/greldal/static/favicons/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/greldal/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/greldal/static/favicons/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/greldal/static/favicons/favicon-16x16.png"/><meta name="msapplication-TileColor" content="#E535AB"/><meta name="msapplication-TileImage" content="/greldal/static/favicons/ms-icon-144x144.png"/><meta name="theme-color" content="#E535AB"/><style data-styled="" data-styled-version="5.1.0">.kkVBdj{cursor:pointer;background:black;padding:5px;text-transform:uppercase;border-radius:4px;margin:1.6rem 0;color:white !important;}/*!sc*/
data-styled.g1[id="Link__Anchor-sc-1hbrjrd-0"]{content:"kkVBdj,"}/*!sc*/
.dCMmPM{margin-right:5px;float:right;margin-left:10px;padding-left:5px;border-left:1px solid white;}/*!sc*/
data-styled.g3[id="Link___StyledTrailingIcon-sc-1hbrjrd-2"]{content:"dCMmPM,"}/*!sc*/
.dJUrsX{float:left;background:gray;margin:-5px;padding:5px 10px;border-radius:4px 0 0 4px;margin-right:5px;}/*!sc*/
data-styled.g4[id="Link___StyledDiv-sc-1hbrjrd-3"]{content:"dJUrsX,"}/*!sc*/
</style><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/greldal/_next/static/css/styles.3f31de7e.chunk.css" as="style"/><link rel="stylesheet" href="/greldal/_next/static/css/styles.3f31de7e.chunk.css"/><link rel="preload" href="/greldal/_next/static/lpglMTbhI7ggGpTTBL7SE/pages/stored-procedures.js" as="script"/><link rel="preload" href="/greldal/_next/static/lpglMTbhI7ggGpTTBL7SE/pages/_app.js" as="script"/><link rel="preload" href="/greldal/_next/static/runtime/webpack-87eff0b30634ffd1130f.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/framework.92bd6b81c7da20fc6c75.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/2edb282b.370272d698b8c8d41792.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/7e89b4665ebfb4e2abee2bef71a05dfe376a77b6.3a91582121712f3411ed.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/4ebced11ac36390013b50dcef1fd591cb340c7b5.fd8c4f31fe61facb6f72.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/02abb9f2192c059886bd6ee9226145a49ec8715a.1dda0faff8ebe31b997c.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/29306ec1e1eec19b653e3c2aaf5a2c2962a91283.e86b241b0a1b5328fa70.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/a2c33cfc241765541f359ae2ec975d0be50f699b.77315c05aa506cacb3cc.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/7544df931d66d9af443d9fb326c8ce2e935a04f4.a6811910484b213cdf8d.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/styles.87da95fba9c273dcf072.js" as="script"/><link rel="preload" href="/greldal/_next/static/runtime/main-1550f615cb6b2e6d8e09.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/036b8216dd67783cdf1ce824d45a08631a525868.692a5fc571ad36f82720.js" as="script"/></head><body class="custom_class"><div id="__next"><div style="display:none"><div class="Sidebar__SidebarContainer-sc-1bydltt-0 Sidebar__FixedSidebarContainer-sc-1bydltt-1 fSRNVE"><div style="padding-bottom:10px;display:flex;flex-direction:row;cursor:pointer"><img src="/greldal/_next/static/images/d3212937ee582435973cbc81840d0e66.png" style="height:50px;width:50px"/><div style="font-weight:600;font-size:2rem;line-height:50px;padding-left:10px;color:#8dd35f">GRelDAL<span class="LibInfoBanner___StyledSpan-jtu4hg-0 hRspAa">Beta</span></div></div><a class="Link__Anchor-sc-1hbrjrd-0 kkVBdj"><div class="Link__TrailingIcon-sc-1hbrjrd-1 etAccT">→</div>API</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Quick Start</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Playground</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Frequently Asked Questions</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><h1 class="Sidebar__SectionHeader-sc-1bydltt-2 bJPDhy">Guides</h1></a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Mapping Data Sources</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Mapping Operations</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Mapping Associations</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Stored Procedures</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Subscriptions</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Best Practices</a><h1 class="Sidebar__SectionHeader-sc-1bydltt-2 bJPDhy">Additional Topics</h1><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Type Safety</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Comparision With Alternatives</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Architecture Overview</a></div><div id="container" class="PageLayout__ContentContainer-ct4rbe-5 PageLayout__DesktopContentContainer-ct4rbe-6 LwAci"><div><h1 id="stored-procedures"><a href="#stored-procedures" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Stored Procedures</h1><p>GRelDAL supports mapping GraphQL Operations to stored procedures or user defined functions.</p><h2 id="user-defined-functions"><a href="#user-defined-functions" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>User defined functions:</h2><p>From <a href="https://en.wikipedia.org/wiki/User-defined_function">Wikipedia</a>: </p><blockquote><p>In relational database management systems, a user-defined function provides a mechanism for extending the functionality of the database server by adding a function, that can be evaluated in standard query language (usually SQL) statements. </p></blockquote><p>Here is an example of a simple UDF that adds two numbers: </p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8"><code>CREATE OR REPLACE FUNCTION get_sum(a numeric, b numeric)
RETURNS NUMERIC AS $$
BEGIN
    RETURN a + b;
END; $$ language plpgsql;</code></pre><p>We can map this UDF to a GrelDAL operation using the <code>mapUserDefinedFunction</code> function: </p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8"><code>mapUserDefinedFunction({
    <span class="hljs-attr">name</span>: {
        <span class="hljs-attr">stored</span>: <span style="color:#d14">&quot;get_sum&quot;</span>,
        <span class="hljs-attr">mapped</span>: <span style="color:#d14">&quot;getSum&quot;</span>,
    },
    <span class="hljs-attr">args</span>: mapArgs({
        <span class="hljs-attr">a</span>: { <span class="hljs-attr">type</span>: types.number },
        <span class="hljs-attr">b</span>: { <span class="hljs-attr">type</span>: types.number },
    }),
    <span class="hljs-attr">returnType</span>: GraphQLFloat,
    <span class="hljs-attr">deriveParams</span>: <span class="hljs-function">(<span class="hljs-params">{ a, b }</span>) =&gt;</span> [
        {
            <span class="hljs-attr">name</span>: <span style="color:#d14">&quot;a&quot;</span>,
            <span class="hljs-attr">value</span>: a,
            <span class="hljs-attr">argMode</span>: <span style="color:#d14">&quot;IN&quot;</span>,
        },
        {
            <span class="hljs-attr">name</span>: <span style="color:#d14">&quot;b&quot;</span>,
            <span class="hljs-attr">value</span>: b,
            <span class="hljs-attr">argMode</span>: <span style="color:#d14">&quot;IN&quot;</span>,
        },
    ],
}),</code></pre><p>We can expose this operation in the GraphQL API by passing the above to the <code>mapSchema</code> function similar to any other operation.</p><p>Once exposed, we can use GraphQL to perform the operation: </p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8"><code><span style="color:#333;font-weight:bold">const</span> graphQLResult = <span style="color:#333;font-weight:bold">await</span> graphql(
    schema,
    <span style="color:#d14">`
        mutation {
            getSum(a: 1, b: 2)
        }
    `</span>,
);</code></pre><h2 id="stored-procedures-1"><a href="#stored-procedures-1" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Stored Procedures:</h2><p>From <a href="https://en.wikipedia.org/wiki/Stored_procedure">Wikipedia</a></p><blockquote><p>A stored procedure (also termed proc, storp, sproc, StoPro, StoredProc, StoreProc, sp, or SP) is a subroutine available to applications that access a relational database management system (RDBMS). Such procedures are stored in the database data dictionary.</p></blockquote><p>Stored procedures are usually more powerful than User defined functions in that they can perform transactions and return multiple values. </p><p>The syntax of defining stored procedures differs across databases: </p><p>Here is an example of defining a stored procedure in MySQL: </p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8"><code>CREATE PROCEDURE get_avg_user_age(
    INOUT avg_age INT
)
BEGIN
    SELECT AVG(age)
    INTO @avg_age
    FROM users;

    SET avg_age = @avg_age;
END</code></pre><p>Here is the equivalent in PostgreSQL (using PL/PgSQL): </p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8"><code>CREATE OR REPLACE PROCEDURE get_avg_user_age(
    INOUT avg_age INT
)
LANGUAGE plpgsql
AS $$
    BEGIN
        SELECT AVG(age)
        INTO avg_age
        FROM users;
    END;
$$</code></pre><p>We can map this stored proc to a GrelDAL operation using the <code>mapStoredProcedure</code> function: </p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8"><code>mapStoredProcedure({
    <span class="hljs-attr">type</span>: <span style="color:#d14">&quot;query&quot;</span>,
    <span class="hljs-attr">name</span>: {
        <span class="hljs-attr">stored</span>: <span style="color:#d14">&quot;get_avg_user_age&quot;</span>,
        <span class="hljs-attr">mapped</span>: <span style="color:#d14">&quot;getAvgAge&quot;</span>,
    },
    <span class="hljs-attr">args</span>: mapArgs({}),
    <span class="hljs-attr">returnType</span>: GraphQLInt,
    <span class="hljs-attr">deriveParams</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> [
        {
            <span class="hljs-attr">name</span>: <span style="color:#d14">&quot;avg_age&quot;</span>,
            <span class="hljs-attr">argMode</span>: <span style="color:#d14">&quot;INOUT&quot;</span> <span style="color:#333;font-weight:bold">as</span> <span style="color:#333;font-weight:bold">const</span>,
            <span class="hljs-attr">value</span>: <span style="color:#008080">undefined</span>,
        },
    ],
    <span class="hljs-attr">deriveResult</span>: <span class="hljs-function">(<span class="hljs-params">r: any</span>) =&gt;</span> r.avg_age,
}),</code></pre><p>We can expose this operation in the GraphQL API by passing the above to the <code>mapSchema</code> function similar to any other operation.</p><p>Once exposed, we can use GraphQL to perform the operation: </p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8"><code><span style="color:#333;font-weight:bold">const</span> graphQLResult = <span style="color:#333;font-weight:bold">await</span> graphql(
    schema,
    <span style="color:#d14">`
        query {
            getAvgAge
        }
    `</span>,
);</code></pre><a class="Link__Anchor-sc-1hbrjrd-0 kkVBdj" style="display:inline-block;cursor:pointer"><div class="Link__TrailingIcon-sc-1hbrjrd-1 Link___StyledTrailingIcon-sc-1hbrjrd-2 dCMmPM">⯈</div><div class="Link___StyledDiv-sc-1hbrjrd-3 dJUrsX">Next</div> <strong>Subscriptions</strong></a></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/stored-procedures","query":{},"buildId":"lpglMTbhI7ggGpTTBL7SE","assetPrefix":"/greldal","nextExport":true,"isFallback":false,"appGip":true}</script><script nomodule="" src="/greldal/_next/static/runtime/polyfills-2b357385e9a0bfe15896.js"></script><script async="" data-next-page="/stored-procedures" src="/greldal/_next/static/lpglMTbhI7ggGpTTBL7SE/pages/stored-procedures.js"></script><script async="" data-next-page="/_app" src="/greldal/_next/static/lpglMTbhI7ggGpTTBL7SE/pages/_app.js"></script><script src="/greldal/_next/static/runtime/webpack-87eff0b30634ffd1130f.js" async=""></script><script src="/greldal/_next/static/chunks/framework.92bd6b81c7da20fc6c75.js" async=""></script><script src="/greldal/_next/static/chunks/2edb282b.370272d698b8c8d41792.js" async=""></script><script src="/greldal/_next/static/chunks/7e89b4665ebfb4e2abee2bef71a05dfe376a77b6.3a91582121712f3411ed.js" async=""></script><script src="/greldal/_next/static/chunks/4ebced11ac36390013b50dcef1fd591cb340c7b5.fd8c4f31fe61facb6f72.js" async=""></script><script src="/greldal/_next/static/chunks/02abb9f2192c059886bd6ee9226145a49ec8715a.1dda0faff8ebe31b997c.js" async=""></script><script src="/greldal/_next/static/chunks/29306ec1e1eec19b653e3c2aaf5a2c2962a91283.e86b241b0a1b5328fa70.js" async=""></script><script src="/greldal/_next/static/chunks/a2c33cfc241765541f359ae2ec975d0be50f699b.77315c05aa506cacb3cc.js" async=""></script><script src="/greldal/_next/static/chunks/7544df931d66d9af443d9fb326c8ce2e935a04f4.a6811910484b213cdf8d.js" async=""></script><script src="/greldal/_next/static/chunks/styles.87da95fba9c273dcf072.js" async=""></script><script src="/greldal/_next/static/runtime/main-1550f615cb6b2e6d8e09.js" async=""></script><script src="/greldal/_next/static/chunks/036b8216dd67783cdf1ce824d45a08631a525868.692a5fc571ad36f82720.js" async=""></script><script src="/greldal/_next/static/lpglMTbhI7ggGpTTBL7SE/_buildManifest.js" async=""></script><script src="/greldal/_next/static/lpglMTbhI7ggGpTTBL7SE/_ssgManifest.js" async=""></script></body></html>