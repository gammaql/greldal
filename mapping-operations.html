<!DOCTYPE html><html lang="id"><head><meta charSet="utf-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><link rel="apple-touch-icon" sizes="57x57" href="/greldal/static/favicons/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/greldal/static/favicons/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/greldal/static/favicons/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/greldal/static/favicons/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/greldal/static/favicons/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/greldal/static/favicons/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/greldal/static/favicons/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/greldal/static/favicons/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/greldal/static/favicons/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/greldal/static/favicons/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/greldal/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/greldal/static/favicons/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/greldal/static/favicons/favicon-16x16.png"/><meta name="msapplication-TileColor" content="#E535AB"/><meta name="msapplication-TileImage" content="/greldal/static/favicons/ms-icon-144x144.png"/><meta name="theme-color" content="#E535AB"/><style data-styled="" data-styled-version="5.1.0">.iTeElz{cursor:pointer;}/*!sc*/
.kkVBdj{cursor:pointer;background:black;padding:5px;text-transform:uppercase;border-radius:4px;margin:1.6rem 0;color:white !important;}/*!sc*/
data-styled.g1[id="Link__Anchor-sc-1hbrjrd-0"]{content:"iTeElz,kkVBdj,"}/*!sc*/
.dCMmPM{margin-right:5px;float:right;margin-left:10px;padding-left:5px;border-left:1px solid white;}/*!sc*/
data-styled.g3[id="Link___StyledTrailingIcon-sc-1hbrjrd-2"]{content:"dCMmPM,"}/*!sc*/
.dJUrsX{float:left;background:gray;margin:-5px;padding:5px 10px;border-radius:4px 0 0 4px;margin-right:5px;}/*!sc*/
data-styled.g4[id="Link___StyledDiv-sc-1hbrjrd-3"]{content:"dJUrsX,"}/*!sc*/
</style><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/greldal/_next/static/css/styles.3f31de7e.chunk.css" as="style"/><link rel="stylesheet" href="/greldal/_next/static/css/styles.3f31de7e.chunk.css"/><link rel="preload" href="/greldal/_next/static/lpglMTbhI7ggGpTTBL7SE/pages/mapping-operations.js" as="script"/><link rel="preload" href="/greldal/_next/static/lpglMTbhI7ggGpTTBL7SE/pages/_app.js" as="script"/><link rel="preload" href="/greldal/_next/static/runtime/webpack-87eff0b30634ffd1130f.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/framework.92bd6b81c7da20fc6c75.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/2edb282b.370272d698b8c8d41792.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/7e89b4665ebfb4e2abee2bef71a05dfe376a77b6.3a91582121712f3411ed.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/4ebced11ac36390013b50dcef1fd591cb340c7b5.fd8c4f31fe61facb6f72.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/02abb9f2192c059886bd6ee9226145a49ec8715a.1dda0faff8ebe31b997c.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/29306ec1e1eec19b653e3c2aaf5a2c2962a91283.e86b241b0a1b5328fa70.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/a2c33cfc241765541f359ae2ec975d0be50f699b.77315c05aa506cacb3cc.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/7544df931d66d9af443d9fb326c8ce2e935a04f4.a6811910484b213cdf8d.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/styles.87da95fba9c273dcf072.js" as="script"/><link rel="preload" href="/greldal/_next/static/runtime/main-1550f615cb6b2e6d8e09.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/036b8216dd67783cdf1ce824d45a08631a525868.692a5fc571ad36f82720.js" as="script"/></head><body class="custom_class"><div id="__next"><div style="display:none"><div class="Sidebar__SidebarContainer-sc-1bydltt-0 Sidebar__FixedSidebarContainer-sc-1bydltt-1 fSRNVE"><div style="padding-bottom:10px;display:flex;flex-direction:row;cursor:pointer"><img src="/greldal/_next/static/images/d3212937ee582435973cbc81840d0e66.png" style="height:50px;width:50px"/><div style="font-weight:600;font-size:2rem;line-height:50px;padding-left:10px;color:#8dd35f">GRelDAL<span class="LibInfoBanner___StyledSpan-jtu4hg-0 hRspAa">Beta</span></div></div><a class="Link__Anchor-sc-1hbrjrd-0 kkVBdj"><div class="Link__TrailingIcon-sc-1hbrjrd-1 etAccT">→</div>API</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Quick Start</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Playground</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Frequently Asked Questions</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><h1 class="Sidebar__SectionHeader-sc-1bydltt-2 bJPDhy">Guides</h1></a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Mapping Data Sources</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Mapping Operations</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Mapping Associations</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Stored Procedures</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Subscriptions</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Best Practices</a><h1 class="Sidebar__SectionHeader-sc-1bydltt-2 bJPDhy">Additional Topics</h1><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Type Safety</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Comparision With Alternatives</a><a class="Link__Anchor-sc-1hbrjrd-0 iTeElz"><span class="Sidebar__Bolt-sc-1bydltt-3 eJkLzs">⚡</span>Architecture Overview</a></div><div id="container" class="PageLayout__ContentContainer-ct4rbe-5 PageLayout__DesktopContentContainer-ct4rbe-6 LwAci"><div><h1 id="mapping-operations"><a href="#mapping-operations" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Mapping Operations</h1><p>GRelDAL supports two types of GraphQL operations: <a href="https://graphql.org/learn/schema/#the-query-and-mutation-types">Queries and Mutations</a>.</p><p>Let us say we have following data source mapping:</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8"><code><span style="color:#333;font-weight:bold">import</span> {mapDataSource, mapFields, types} <span style="color:#333;font-weight:bold">from</span> <span style="color:#d14">&quot;greldal&quot;</span>;

<span style="color:#333;font-weight:bold">const</span> users = mapDataSource({
    <span class="hljs-attr">name</span>: <span style="color:#d14">&quot;User&quot;</span>,
    <span class="hljs-attr">fields</span>: mapFields({
        <span class="hljs-attr">id</span>: {
            <span class="hljs-attr">type</span>: types.intId,
            <span class="hljs-attr">isPrimary</span>: <span style="color:#008080">true</span>,
        },
        <span class="hljs-attr">name</span>: {
            <span class="hljs-attr">type</span>: types.string,
        },
        <span class="hljs-attr">age</span>: {
            <span class="hljs-attr">type</span>: types.integer,
        },
    }),
});</code></pre><p>Now we want to allow users to operate on this data source.
The most convenient way to make this happen is through one of pre-defined operation presets.</p><pre><code class="hljs language-ts" metaString=""><span class="hljs-keyword">import</span> { operationPresets } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;greldal&quot;</span>;

<span class="hljs-keyword">const</span> schema = mapSchema([operationPresets.query.findOneOperation(users)]);</code></pre><p>A <code>findOne</code> operation allows us to query the users table like this:</p><pre><code>query {
    findOneUser(where: {id: 1}) {
        id
        name
    }
}
</code></pre><p>This will result in an SQL query like:</p><pre><code class="hljs language-sql" metaString=""><span class="hljs-keyword">select</span>
    <span class="hljs-string">`GQL_DAL_users__4`</span>.<span class="hljs-string">`id`</span> <span class="hljs-keyword">as</span> <span class="hljs-string">`GQL_DAL_users__4__id`</span>,
    <span class="hljs-string">`GQL_DAL_users__4`</span>.<span class="hljs-string">`name`</span> <span class="hljs-keyword">as</span> <span class="hljs-string">`GQL_DAL_users__4__name`</span>
<span class="hljs-keyword">from</span> <span class="hljs-string">`users`</span> <span class="hljs-keyword">as</span> <span class="hljs-string">`GQL_DAL_users__4`</span>
<span class="hljs-keyword">where</span> <span class="hljs-string">`GQL_DAL_users__4`</span>.<span class="hljs-string">`id`</span> = <span class="hljs-number">1</span>
<span class="hljs-keyword">limit</span> <span class="hljs-number">1</span></code></pre><p>The preset assumes that the properties of <code>args.where</code> map exactly to field names and we want to fetch results that match all of these values.</p><h2 id="pagination-support"><a href="#pagination-support" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Pagination support</h2><p>It is possible to add pagination support for <code>findManyOperation</code> through <code>paginatedFindManyOperation</code> preset:</p><pre><code class="hljs language-ts" metaString="">mapSchema([operationPresets.paginatedFindManyOperation(users)]);</code></pre><p>The default implementation assumes sequentially incrementing primary fields and will fail if that is not the case.</p><p>We can separately configure a monotically increasing column to be used as a cursor:</p><pre><code class="hljs language-ts" metaString="">mapSchema([
    operationPresets.paginatedFindManyOperation(users, <span class="hljs-function"><span class="hljs-params">mapping</span> =&gt;</span> ({
        ...mapping,
        cursorColumn: <span class="hljs-string">&quot;ts&quot;</span>,
    })),
]);</code></pre><p>This results in GraphQL types like:</p><pre><code>type GRelDALPageInfo {
  prevCursor: String
  nextCursor: String
  totalCount: Int
}

type query {
  findManyUsers(where: UserInput!): UserPageContainer
}

type User {
  id: ID
  name: String
  age: Int
}

type UserPage {
  pageInfo: GRelDALPageInfo
  entities: [User]
}

type UserPageContainer {
  page(cursor: String, pageSize: Int): UserPage
}
</code></pre><hr/><h2 id="beyond-crud-operations"><a href="#beyond-crud-operations" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Beyond CRUD Operations</h2><p>In real world applications we would often want more flexibility in terms of how the arguments map to queries.</p><p>We will see a couple of approaches for this:</p><h2 id="computed-fields"><a href="#computed-fields" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Computed Fields</h2><p>One approach that we have <a class="Link__Anchor-sc-1hbrjrd-0 iTeElz">already seen</a> is by defining computed fields in the data source mapping. GRelDQL can automatically resolve computed fields by mapping them to underlying concrete fields and deriving computed values from them.</p><h2 id="argument-mapping"><a href="#argument-mapping" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Argument Mapping</h2><p>We can also specify the exact arguments we want to expose in our operation and how they map to SQL:</p><pre><code class="hljs language-ts" metaString=""><span class="hljs-keyword">const</span> argMapping = mapArgs({
    fullName: mapFields({
        description: <span class="hljs-string">&quot;Full name of user&quot;</span>,
        <span class="hljs-keyword">type</span>: t.string,
        interceptQuery: <span class="hljs-function">(<span class="hljs-params">queryBuilder: Knex.QueryBuilder, value: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
            <span class="hljs-keyword">const</span> names = value.split(<span class="hljs-string">&quot; &quot;</span>);
            <span class="hljs-keyword">return</span> queryBuilder.where({
                first_name: names[<span class="hljs-number">0</span>],
                last_name: names[<span class="hljs-number">1</span>],
            });
        },
    }),
});

<span class="hljs-keyword">const</span> schema = mapSchema([
    <span class="hljs-keyword">new</span> MappedSingleSourceQueryOperation({
        name: <span class="hljs-string">&quot;findUsersByFullName&quot;</span>,
        rootSource: mappedDataSource,
        singular: <span class="hljs-literal">true</span>,
        args: argMapping,
    }),
]);</code></pre><h2 id="custom-operation-resolvers"><a href="#custom-operation-resolvers" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Custom (operation) resolvers</h2><p>Often your business logic will not exactly map to a single database operation, and you&#x27;d want to execute custom logic in your resolvers.</p><p>At a broad level we can have two potential scenarios:</p><h3 id="resolvers-that-dont-need-database-access-at-all"><a href="#resolvers-that-dont-need-database-access-at-all" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Resolvers that don&#x27;t need database access at all</h3><p>GRelDAL is primarily helpful for mapping GraphQL APIs to databases. However in many cases, a few resolvers will simply call external APIs, or do some in-memory computation, or access a local file etc. and return data. </p><p>GRelDAL doesn&#x27;t have anything to make such use cases easier, but it does make it easy to have such resolvers live alongside GRelDAL powered resolvers, and be a part of the same GraphQL without any schema-stitching. </p><p><code>mapSchema</code> function accepts an array of operations. These operations are objects that conform to the <code>Operation</code> interface.</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8"><code><span style="color:#998;font-style:italic">/**
* Interface that all operations application must confirm to.
*
* These operations may be source aware (which interact with GRelDAL data sources)
* or completely generic (which may simply wrap graphql.js compatible resolvers).
*/</span>
<span style="color:#333;font-weight:bold">export</span> interface Operation {
   <span class="hljs-attr">operationType</span>: OperationType;
   name: string;
   fieldConfig: GraphQLFieldConfig&lt;any, any, any&gt;;
}</code></pre><p>The <code>fieldConfig</code> property here is any graphql-js compatible <a href="https://github.com/graphql/graphql-js/blob/49d86bbc810d1203aa3f7d93252e51f257d9460f/docs/APIReference-TypeSystem.md#graphqlobjecttype">FieldConfig</a>.</p><p><strong>Examples:</strong></p><p><strong>Simple Custom operation (without any args):</strong></p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8"><code><span style="color:#333;font-weight:bold">const</span> customOperation = {
    <span class="hljs-attr">operationType</span>: OperationType.Query,
    <span class="hljs-attr">name</span>: <span style="color:#d14">&quot;printHello&quot;</span>,
    <span class="hljs-attr">fieldConfig</span>: {
        <span class="hljs-attr">type</span>: GraphQLString,
        <span class="hljs-attr">description</span>: <span style="color:#d14">&quot;Prints hello&quot;</span>,
        <span class="hljs-attr">resolve</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            <span style="color:#333;font-weight:bold">return</span> <span style="color:#d14">&quot;hello&quot;</span>;
        },
    },
};
<span style="color:#333;font-weight:bold">const</span> schema = mapSchema([customOperation]);</code></pre><p><strong>Custom operation that accepts args:</strong></p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8"><code><span style="color:#333;font-weight:bold">const</span> customOperation = {
    <span class="hljs-attr">operationType</span>: OperationType.Query,
    <span class="hljs-attr">name</span>: <span style="color:#d14">&quot;printGreeting&quot;</span>,
    <span class="hljs-attr">fieldConfig</span>: {
        <span class="hljs-attr">type</span>: GraphQLString,
        <span class="hljs-attr">args</span>: {
            <span class="hljs-attr">name</span>: {
                <span class="hljs-attr">type</span>: GraphQLString,
                <span class="hljs-attr">defaultValue</span>: <span style="color:#d14">&quot;Lorefnon&quot;</span>,
            },
        },
        <span class="hljs-attr">description</span>: <span style="color:#d14">&quot;Prints hello&quot;</span>,
        <span class="hljs-attr">resolve</span>: <span class="hljs-function">(<span class="hljs-params">_obj: any, args: { name: string }</span>) =&gt;</span> {
            <span style="color:#333;font-weight:bold">return</span> <span style="color:#d14">`hello <span style="color:#333;font-weight:normal">${args.name}</span>`</span>;
        },
    },
};
<span style="color:#333;font-weight:bold">const</span> schema = mapSchema([customOperation]);</code></pre><h3 id="specifying-types-through-io-ts"><a href="#specifying-types-through-io-ts" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Specifying types through io-ts</h3><p>GRelDAL supports specifying input/output types of operations through io-ts. </p><p>This has the benefit that we can auto-derive the typescript types and use them elsewhere in our code. </p><p>For example: </p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8"><code><span style="color:#333;font-weight:bold">const</span> OrderDetailTypeSpec = types.object(<span style="color:#d14">&quot;OrderDetail&quot;</span>, {
    <span class="hljs-attr">orderId</span>: types.number,
    <span class="hljs-attr">purchasedAt</span>: types.isoDate,
    <span class="hljs-attr">purchasedBy</span>: types.array(
        types.object(<span style="color:#d14">&quot;OrderDetailPurchaser&quot;</span>, {
            <span class="hljs-attr">customerId</span>: types.number,
            <span class="hljs-attr">name</span>: types.string,
        }),
    ),
});
type OrderDetail = <span style="color:#333;font-weight:bold">typeof</span> OrderDetailTypeSpec[<span style="color:#d14">&quot;Type&quot;</span>];
<span style="color:#333;font-weight:bold">const</span> customOperation = {
    <span class="hljs-attr">operationType</span>: OperationType.Query,
    <span class="hljs-attr">name</span>: <span style="color:#d14">&quot;orderDetails&quot;</span>,
    <span class="hljs-attr">fieldConfig</span>: {
        <span class="hljs-attr">type</span>: OrderDetailTypeSpec.graphQLOutputType,
        <span class="hljs-attr">args</span>: {
            <span class="hljs-attr">orderId</span>: {
                <span class="hljs-attr">type</span>: types.number.graphQLInputType,
            },
        },
        <span class="hljs-attr">description</span>: <span style="color:#d14">&quot;Prints hello&quot;</span>,
        <span class="hljs-attr">resolve</span>: (_parent: any, <span class="hljs-attr">args</span>: { <span class="hljs-attr">orderId</span>: number }): <span class="hljs-function"><span class="hljs-params">OrderDetail</span> =&gt;</span> ({
            <span class="hljs-attr">orderId</span>: args.orderId,
            <span class="hljs-attr">purchasedAt</span>: <span style="color:#333;font-weight:bold">new</span> <span style="color:#0086b3">Date</span>(<span style="color:#d14">&quot;2020-01-01&quot;</span>),
            <span class="hljs-attr">purchasedBy</span>: [
                {
                    <span class="hljs-attr">customerId</span>: <span style="color:#008080">1</span>,
                    <span class="hljs-attr">name</span>: <span style="color:#d14">&quot;John Doe&quot;</span>,
                },
                {
                    <span class="hljs-attr">customerId</span>: <span style="color:#008080">2</span>,
                    <span class="hljs-attr">name</span>: <span style="color:#d14">&quot;Jane Doe&quot;</span>,
                },
            ],
        }),
    },
};
<span style="color:#333;font-weight:bold">const</span> schema = mapSchema([customOperation]);</code></pre><p>We can check upon the generated graphql types through an introspection query: </p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8"><code><span style="color:#333;font-weight:bold">const</span> introspectionResult = <span style="color:#333;font-weight:bold">await</span> graphql(
    schema,
    <span style="color:#d14">`
        query {
            __schema {
                types {
                    name
                    fields {
                        name
                        type {
                            name
                        }
                    }
                }
            }
        }
    `</span>,
);</code></pre><p>Which will give us something like: </p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8"><code><span style="color:#0086b3">Object</span> {
  <span style="color:#d14">&quot;data&quot;</span>: <span style="color:#0086b3">Object</span> {
    <span style="color:#d14">&quot;__schema&quot;</span>: <span style="color:#0086b3">Object</span> {
      <span style="color:#d14">&quot;types&quot;</span>: <span style="color:#0086b3">Array</span> [
        <span style="color:#0086b3">Object</span> {
          <span style="color:#d14">&quot;fields&quot;</span>: <span style="color:#0086b3">Array</span> [
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;orderDetails&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;OrderDetail&quot;</span>,
              },
            },
          ],
          <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;query&quot;</span>,
        },
        <span style="color:#0086b3">Object</span> {
          <span style="color:#d14">&quot;fields&quot;</span>: <span style="color:#008080">null</span>,
          <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;Float&quot;</span>,
        },
        <span style="color:#0086b3">Object</span> {
          <span style="color:#d14">&quot;fields&quot;</span>: <span style="color:#0086b3">Array</span> [
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;orderId&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;Float&quot;</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;purchasedAt&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;Date&quot;</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;purchasedBy&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
          ],
          <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;OrderDetail&quot;</span>,
        },
        <span style="color:#0086b3">Object</span> {
          <span style="color:#d14">&quot;fields&quot;</span>: <span style="color:#008080">null</span>,
          <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;Date&quot;</span>,
        },
        <span style="color:#0086b3">Object</span> {
          <span style="color:#d14">&quot;fields&quot;</span>: <span style="color:#0086b3">Array</span> [
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;customerId&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;Float&quot;</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;name&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;String&quot;</span>,
              },
            },
          ],
          <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;OrderDetailPurchaser&quot;</span>,
        },
        <span style="color:#0086b3">Object</span> {
          <span style="color:#d14">&quot;fields&quot;</span>: <span style="color:#008080">null</span>,
          <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;String&quot;</span>,
        },
        <span style="color:#0086b3">Object</span> {
          <span style="color:#d14">&quot;fields&quot;</span>: <span style="color:#0086b3">Array</span> [
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;types&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;queryType&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;mutationType&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;__Type&quot;</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;subscriptionType&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;__Type&quot;</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;directives&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
          ],
          <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;__Schema&quot;</span>,
        },
        <span style="color:#0086b3">Object</span> {
          <span style="color:#d14">&quot;fields&quot;</span>: <span style="color:#0086b3">Array</span> [
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;kind&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;name&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;String&quot;</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;description&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;String&quot;</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;fields&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;interfaces&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;possibleTypes&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;enumValues&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;inputFields&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;ofType&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;__Type&quot;</span>,
              },
            },
          ],
          <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;__Type&quot;</span>,
        },
        <span style="color:#0086b3">Object</span> {
          <span style="color:#d14">&quot;fields&quot;</span>: <span style="color:#008080">null</span>,
          <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;__TypeKind&quot;</span>,
        },
        <span style="color:#0086b3">Object</span> {
          <span style="color:#d14">&quot;fields&quot;</span>: <span style="color:#008080">null</span>,
          <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;Boolean&quot;</span>,
        },
        <span style="color:#0086b3">Object</span> {
          <span style="color:#d14">&quot;fields&quot;</span>: <span style="color:#0086b3">Array</span> [
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;name&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;description&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;String&quot;</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;args&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;type&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;isDeprecated&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;deprecationReason&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;String&quot;</span>,
              },
            },
          ],
          <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;__Field&quot;</span>,
        },
        <span style="color:#0086b3">Object</span> {
          <span style="color:#d14">&quot;fields&quot;</span>: <span style="color:#0086b3">Array</span> [
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;name&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;description&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;String&quot;</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;type&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;defaultValue&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;String&quot;</span>,
              },
            },
          ],
          <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;__InputValue&quot;</span>,
        },
        <span style="color:#0086b3">Object</span> {
          <span style="color:#d14">&quot;fields&quot;</span>: <span style="color:#0086b3">Array</span> [
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;name&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;description&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;String&quot;</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;isDeprecated&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;deprecationReason&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;String&quot;</span>,
              },
            },
          ],
          <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;__EnumValue&quot;</span>,
        },
        <span style="color:#0086b3">Object</span> {
          <span style="color:#d14">&quot;fields&quot;</span>: <span style="color:#0086b3">Array</span> [
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;name&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;description&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;String&quot;</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;locations&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
            <span style="color:#0086b3">Object</span> {
              <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;args&quot;</span>,
              <span style="color:#d14">&quot;type&quot;</span>: <span style="color:#0086b3">Object</span> {
                <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#008080">null</span>,
              },
            },
          ],
          <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;__Directive&quot;</span>,
        },
        <span style="color:#0086b3">Object</span> {
          <span style="color:#d14">&quot;fields&quot;</span>: <span style="color:#008080">null</span>,
          <span style="color:#d14">&quot;name&quot;</span>: <span style="color:#d14">&quot;__DirectiveLocation&quot;</span>,
        },
      ],
    },
  },
}</code></pre><h3 id="resolvers-that-need-database-access"><a href="#resolvers-that-need-database-access" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Resolvers that need database access</h3><p>We can use the above approach to interact with database directly using Knex (or any other library). But GRelDAL makes this
use case slightly simpler through <code>SourceAwareOperationResolver</code> class.</p><p>More often than not, a resolver will delegate to one or more of other operation resolvers as illustrated below:</p><pre><code class="hljs language-ts" metaString=""><span class="hljs-keyword">import</span> {SourceAwareOperationResolver, MappedSingleSourceQueryOperation} <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;greldal&quot;</span>;

<span class="hljs-keyword">const</span> findOperation = operationPresets.query.findOneOperation(users);

<span class="hljs-keyword">class</span> CustomFindOperationResolver <span class="hljs-keyword">extends</span> SourceAwareOperationResolver {
    resolve() {
        <span class="hljs-keyword">return</span> findOperation.resolve({
            <span class="hljs-keyword">this</span>.source,
            {
                department_id: <span class="hljs-keyword">this</span>.args.department
            },
            <span class="hljs-keyword">this</span>.context,
            <span class="hljs-keyword">this</span>.resolveInfoRoot
        });
    }
}

<span class="hljs-keyword">const</span> schema = mapSchema([
    <span class="hljs-keyword">new</span> MappedSingleSourceQueryOperation({
        name: <span class="hljs-string">&#x27;findByDepartmentId&#x27;</span>,
        rootSource: users,
        singular: <span class="hljs-literal">true</span>,
        args: mapArgs({
            department: {
                <span class="hljs-keyword">type</span>: t.string
            }
        }),
        resolver: <span class="hljs-function">(<span class="hljs-params">operation, source, context, args, resolveInfoRoot</span>) =&gt;</span>
            <span class="hljs-keyword">new</span> CustomFindOperationResolver(
                operation,
                source,
                context,
                args,
                resolveInfoRoot
            )
    })
]);</code></pre><p>Note that we delegated to just a single operation here (<code>findOperation</code>) but we could have delegated to multiple operations and then combined their values, which is common in practice.</p><p>It is also occasionally useful to have <code>resolver</code> function return different resolvers based on the context. So we can choose different resolution strategies (eg. whether or not to query a view) based on what is being queried.</p><p>GRelDAL makes it easy to model complex business logic as a composition of individual operations by leveraging delegation.</p><h2 id="writing-custom-operation-mapping"><a href="#writing-custom-operation-mapping" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Writing custom operation mapping</h2><p>While custom resolvers are flexible enough for most common scenarios, in some cases it may be helpful to write a custom operation mapping which provides a more granular control over how an operation is mapped to the graphql API.</p><p>This approach involves extending the <code>MappedOperation</code> or <code>MappedSourceAwareOperation</code> class and providing a custom implementation for the <code>graphQLOperation</code> getter.</p><hr/><a class="Link__Anchor-sc-1hbrjrd-0 kkVBdj" style="display:inline-block;cursor:pointer"><div class="Link__TrailingIcon-sc-1hbrjrd-1 Link___StyledTrailingIcon-sc-1hbrjrd-2 dCMmPM">⯈</div><div class="Link___StyledDiv-sc-1hbrjrd-3 dJUrsX">Next</div> <strong>Mapping Associations</strong></a></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/mapping-operations","query":{},"buildId":"lpglMTbhI7ggGpTTBL7SE","assetPrefix":"/greldal","nextExport":true,"isFallback":false,"appGip":true}</script><script nomodule="" src="/greldal/_next/static/runtime/polyfills-2b357385e9a0bfe15896.js"></script><script async="" data-next-page="/mapping-operations" src="/greldal/_next/static/lpglMTbhI7ggGpTTBL7SE/pages/mapping-operations.js"></script><script async="" data-next-page="/_app" src="/greldal/_next/static/lpglMTbhI7ggGpTTBL7SE/pages/_app.js"></script><script src="/greldal/_next/static/runtime/webpack-87eff0b30634ffd1130f.js" async=""></script><script src="/greldal/_next/static/chunks/framework.92bd6b81c7da20fc6c75.js" async=""></script><script src="/greldal/_next/static/chunks/2edb282b.370272d698b8c8d41792.js" async=""></script><script src="/greldal/_next/static/chunks/7e89b4665ebfb4e2abee2bef71a05dfe376a77b6.3a91582121712f3411ed.js" async=""></script><script src="/greldal/_next/static/chunks/4ebced11ac36390013b50dcef1fd591cb340c7b5.fd8c4f31fe61facb6f72.js" async=""></script><script src="/greldal/_next/static/chunks/02abb9f2192c059886bd6ee9226145a49ec8715a.1dda0faff8ebe31b997c.js" async=""></script><script src="/greldal/_next/static/chunks/29306ec1e1eec19b653e3c2aaf5a2c2962a91283.e86b241b0a1b5328fa70.js" async=""></script><script src="/greldal/_next/static/chunks/a2c33cfc241765541f359ae2ec975d0be50f699b.77315c05aa506cacb3cc.js" async=""></script><script src="/greldal/_next/static/chunks/7544df931d66d9af443d9fb326c8ce2e935a04f4.a6811910484b213cdf8d.js" async=""></script><script src="/greldal/_next/static/chunks/styles.87da95fba9c273dcf072.js" async=""></script><script src="/greldal/_next/static/runtime/main-1550f615cb6b2e6d8e09.js" async=""></script><script src="/greldal/_next/static/chunks/036b8216dd67783cdf1ce824d45a08631a525868.692a5fc571ad36f82720.js" async=""></script><script src="/greldal/_next/static/lpglMTbhI7ggGpTTBL7SE/_buildManifest.js" async=""></script><script src="/greldal/_next/static/lpglMTbhI7ggGpTTBL7SE/_ssgManifest.js" async=""></script></body></html>