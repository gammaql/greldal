(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"/2Cm":function(e,n,t){"use strict";var o=t("tBqf");e.exports=o},"7VEG":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.withMDXComponents=void 0;var o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},a=s(t("ERkP")),r=s(t("H59W")),i=s(t("aWzz"));function s(e){return e&&e.__esModule?e:{default:e}}var p=(0,r.default)({}),c=p.Provider,u=p.Consumer;n.withMDXComponents=function(e){return function(n){var t=n.components,r=function(e,n){var t={};for(var o in e)n.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}(n,["components"]);return a.default.createElement(u,null,(function(n){return a.default.createElement(e,o({components:t||n},r))}))}};var l=function(e){var n=e.components,t=e.children;return a.default.createElement(c,{value:n},t)};l.propTypes={components:i.default.object.isRequired,children:i.default.element.isRequired},n.default=l},"BS/m":function(e,n,t){"use strict";(function(n){var t="__global_unique_id__";e.exports=function(){return n[t]=(n[t]||0)+1}}).call(this,t("fRV1"))},EWI9:function(e,n,t){"use strict";var o={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r=Object.defineProperty,i=Object.getOwnPropertyNames,s=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,c=Object.getPrototypeOf,u=c&&c(Object);e.exports=function e(n,t,l){if("string"!==typeof t){if(u){var m=c(t);m&&m!==u&&e(n,m,l)}var d=i(t);s&&(d=d.concat(s(t)));for(var f=0;f<d.length;++f){var h=d[f];if(!o[h]&&!a[h]&&(!l||!l[h])){var g=p(t,h);try{r(n,h,g)}catch(v){}}}return n}return n}},H59W:function(e,n,t){"use strict";n.__esModule=!0;var o=r(t("ERkP")),a=r(t("ionY"));function r(e){return e&&e.__esModule?e:{default:e}}n.default=o.default.createContext||a.default,e.exports=n.default},HbGN:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var o=t("+wNj");function a(e,n){if(null==e)return{};var t,a,r=Object(o.a)(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}},RaWv:function(e,n,t){"use strict";var o=t("j/s1").a.div.withConfig({displayName:"NotificationBanner",componentId:"sc-1xeyqo5-0"})(["background:#e15506;padding:20px;color:#ffd0b6;border-radius:5px;text-align:left;& + &{margin-top:10px;}"]);n.a=o},UF1R:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},a=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),r=t("ERkP"),i=c(r),s=c(t("EWI9")),p=t("7VEG");function c(e){return e&&e.__esModule?e:{default:e}}var u={inlineCode:"code",wrapper:"div"},l=function(e){function n(){return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!==typeof n&&"function"!==typeof n?e:n}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(n,e),a(n,[{key:"render",value:function(){var e=this.props,n=e.name,t=e.parentName,a=e.props,r=void 0===a?{}:a,p=e.children,c=e.components,l=void 0===c?{}:c,m=e.Layout,d=e.layoutProps,f=l[t+"."+n]||l[n]||u[n]||n;return m?((0,s.default)(this,m),i.default.createElement(m,o({components:l},d),i.default.createElement(f,r,p))):i.default.createElement(f,r,p)}}]),n}(r.Component);n.default=(0,p.withMDXComponents)(l)},b8zT:function(e,n,t){"use strict";t.r(n);var o=t("HbGN"),a=t("ERkP"),r=t.n(a),i=t("yTr/"),s=t("RaWv"),p=r.a.createElement;n.default=function(e){var n=e.components;Object(o.a)(e,["components"]);return p(i.MDXTag,{name:"wrapper",components:n},p(s.a,null,"\u26a0\ufe0f This document is not an introduction for beginners. If you are new to GRelDAL it is strongly recommended that you first go through the Quick Start section and the guides first."),p(i.MDXTag,{name:"h1",components:n,props:{id:"architecture-overview"}},p(i.MDXTag,{name:"a",components:n,parentName:"h1",props:{href:"#architecture-overview","aria-hidden":"true",tabIndex:-1}},p(i.MDXTag,{name:"span",components:n,parentName:"a",props:{className:"icon icon-link"}})),"Architecture Overview"),p(i.MDXTag,{name:"p",components:n},"This post describes the architecture of GRelDAL at a high level. The primary intended audience are the potential contributors. For lower level specifics, readers are encouraged to read the source."),p(i.MDXTag,{name:"p",components:n},"It is also advisable to go through the terminology section of the API Overview before going through the content below."),p(i.MDXTag,{name:"p",components:n},"There are four primary concepts around which GRelDAL is built:"),p(i.MDXTag,{name:"ol",components:n},p(i.MDXTag,{name:"li",components:n,parentName:"ol"},"Mapped Data Sources"),p(i.MDXTag,{name:"li",components:n,parentName:"ol"},"Mapped Operations"),p(i.MDXTag,{name:"li",components:n,parentName:"ol"},"Operation Resolvers"),p(i.MDXTag,{name:"li",components:n,parentName:"ol"},"Operation Presets")),p(i.MDXTag,{name:"h2",components:n,props:{id:"mapped-data-sources"}},p(i.MDXTag,{name:"a",components:n,parentName:"h2",props:{href:"#mapped-data-sources","aria-hidden":"true",tabIndex:-1}},p(i.MDXTag,{name:"span",components:n,parentName:"a",props:{className:"icon icon-link"}})),"Mapped data sources"),p(i.MDXTag,{name:"p",components:n},"Mapped data sources represent a source in a relational database (usually a table, or a view, sometimes a joined table) which can serve as our primary source of truth."),p(i.MDXTag,{name:"p",components:n},"It is the responsibility of a ",p(i.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"MappedDataSource")," instance to talk to the data source it represents. In many cases the actual data structure we expose to the application layer (referred here as Entities) differs from the table schema of the data source and in these cases it is the responsibility of the mapped data source to transparently convert between these representations and shield the application from having to know about the table schema."),p(i.MDXTag,{name:"p",components:n},"Unlike ORMs, GRelDAL recommends usage of plain old javascript objects as entities."),p(i.MDXTag,{name:"p",components:n},"A ",p(i.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"MappedDataSource")," instance can be constructed by calling the ",p(i.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"mapDataSource")," function, which accepts a mapping configuration.\nThis mapping configuration determines:"),p(i.MDXTag,{name:"ol",components:n},p(i.MDXTag,{name:"li",components:n,parentName:"ol"},"How the columns (in the source) are mapped to fields (of the entity)."),p(i.MDXTag,{name:"li",components:n,parentName:"ol"},"What other data sources this data source can be associated with, and how can these associations be loaded.")),p(i.MDXTag,{name:"p",components:n},'Data sources can "cooperate" (by transforming a shared query builder) when the operation spans over multiple data sources - eg. when performing operations on join tables.'),p(i.MDXTag,{name:"h2",components:n,props:{id:"mapped-operations"}},p(i.MDXTag,{name:"a",components:n,parentName:"h2",props:{href:"#mapped-operations","aria-hidden":"true",tabIndex:-1}},p(i.MDXTag,{name:"span",components:n,parentName:"a",props:{className:"icon icon-link"}})),"Mapped Operations"),p(i.MDXTag,{name:"p",components:n},"Operations generalize the concepts of Queries and mutations in GraphQL."),p(i.MDXTag,{name:"pre",components:n},p(i.MDXTag,{name:"code",components:n,parentName:"pre",props:{metaString:null}},"Operation // Abstract interface for an operation mapSchema can handle (1)\n   ^\n   |\n   |_ MappedOperation // Base class for GRelDAL aware operations\n         ^\n         |\n         |_ MappedSingleSourceOperation    // Base class for operations that operates on a single primary source\n         |     ^\n         |     |_ MappedSingleSourceQueryOperation\n         |     |_ MappedSingleSourceInsertionOperation\n         |     |_ MappedSingleSourceUpdateOperation\n         |     |_ MappedSingleSourceDeletionOperation\n         |\n         |_ MappedMultiSourceOperation    // Base class for operations that operate on multiple sources\n               ^\n               |_ MappedMultiSourceUnionQueryOperation\n")),p(i.MDXTag,{name:"p",components:n},"Operations delegate the actual resolution to an associated operation resolver. All the information that the resolver may need are encapsulated in the ResolverContext DTO which is instantiated by the Operation implementation. "),p(i.MDXTag,{name:"h2",components:n,props:{id:"operation-resolvers"}},p(i.MDXTag,{name:"a",components:n,parentName:"h2",props:{href:"#operation-resolvers","aria-hidden":"true",tabIndex:-1}},p(i.MDXTag,{name:"span",components:n,parentName:"a",props:{className:"icon icon-link"}})),"Operation Resolvers"),p(i.MDXTag,{name:"p",components:n},"Operation resolvers implement the actual logic for resolving the operations. All the ",p(i.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"MappedOperation")," implementations defined by GRelDAL are associated with corresponding default resolvers, however they can be overriden through operation mapping configuration."),p(i.MDXTag,{name:"pre",components:n},p(i.MDXTag,{name:"code",components:n,parentName:"pre",props:{metaString:null}},"Operation                                                                                                      OperationResolver\n   ^                                                                                                                          ^\n   |                                                                                                                          |\nMappedOperation                                                                                                               |\n   |                                                                                                                          |\n   |_ MappedSourceAwareOperation                                                               SourceAwareOperationResolver___|\n         ^                                                                                                         ^\n         |                                                                                                         |\n         |_ MappedSingleSourceOperation                                                                            |\n         |     ^                                                                                                   |\n         |     |_ MappedSingleSourceQueryOperation ------ (defaults to)->     SingleSourceQueryOperationResolver __|\n         |     |_ MappedSingleSourceInsertionOperation -- (defaults to)-> SingleSourceInsertionOperationResolver __|\n         |     |_ MappedSingleSourceUpdateOperation ----- (defaults to)->    SingleSourceUpdateOperationResolver __|\n         |     |_ MappedSingleSourceDeletionOperation --- (defaults to)->  SingleSourceDeletionOperationResolver __|\n         |                                                                                                         |\n         |_ MappedMultiSourceOperation                                                                             |\n               ^                                                                                                   |\n               |_ MappedMultiSourceUnionQueryOperation -- (defaults to)-> MultiSourceUnionQueryOperationResolver __|\n")),p(i.MDXTag,{name:"p",components:n},'Query resolvers can also "delegate" through "side-loading" - this is a better alternative to hierarchical resolution in GraphQL that often results in N+1 query patterns because side-loading supports batch resolution and resolved results are automatically mapped and associated to parent entities.'),p(i.MDXTag,{name:"h2",components:n,props:{id:"operation-presets"}},p(i.MDXTag,{name:"a",components:n,parentName:"h2",props:{href:"#operation-presets","aria-hidden":"true",tabIndex:-1}},p(i.MDXTag,{name:"span",components:n,parentName:"a",props:{className:"icon icon-link"}})),"Operation Presets"),p(i.MDXTag,{name:"p",components:n},"Operation presets are pre-configured operation for common use cases (CRUD operations)."),p(i.MDXTag,{name:"p",components:n},"Despite being pre-configured presets afford a great deal of flexibility because it accomodates custom transformation of mapping through interceptors."),p(i.MDXTag,{name:"h1",components:n,props:{id:"operation-resolution-process"}},p(i.MDXTag,{name:"a",components:n,parentName:"h1",props:{href:"#operation-resolution-process","aria-hidden":"true",tabIndex:-1}},p(i.MDXTag,{name:"span",components:n,parentName:"a",props:{className:"icon icon-link"}})),"Operation resolution process"),p(i.MDXTag,{name:"p",components:n},"GRelDAL is designed to work with graphql.js - the reference implementation of GraphQL provided by facebook."),p(i.MDXTag,{name:"p",components:n},p(i.MDXTag,{name:"inlineCode",components:n,parentName:"p"},"mapSchema")," function constructs a graphql.js compatible schema from a collection of GRelDAL operations. Every operation has a fieldConfig getter that returns a graphql.js compatible fieldConfig. Application can associate interceptors for the fieldConfig which can transform how an operation is mapped to a query/mutation field."),p(i.MDXTag,{name:"p",components:n},"Most of the GraphQL types are derived from the DataSource mapping configuration."),p(i.MDXTag,{name:"p",components:n},"Resolution of a typical GraphQL Query looks something like this:"),p(i.MDXTag,{name:"pre",components:n},p(i.MDXTag,{name:"code",components:n,parentName:"pre",props:{metaString:null}},"              ___\n               |                                         Parsing of GraphQL DSL\n               |                                             |\n               |                                             |\nIn graphql.js -|                                             V\n               |                                         Identify fieldConfig using query/mutation name\n               |                                             |\n               |                                             V\n               |                                         Invoke fieldConfig.resolve\n               |                                             |\n              _|_                  ___                       V\n               |                    |                    Initialize ResolverContext (1)\n               |                    |                        |\n               |                    |                        V\n               |                    |                    Locate OperationResolver implementation\n               |                 In |                        |\n               |    MappedOperation |                        V\n               |                    |                    Initialize OperationResolver with resolverContext\n               |                    |                        |\n               |                    |                        V\n               |                   -+-                   Invoke OperationResolver#resolve\n               |                    |                        |\n               |                    |                        V\n               |                    |                    Invoke dataSource methods to construct SQL query\n           In  |                In  |                        |\n      GRelDAL  | OperationResolver  |_                       V\n               |                    |                    Invoke Knex to construct SQL query\n               |                    |                        |\n               |                    |                        V\n               |                    | In                 Use configured data source connector to run SQL\n               |                    | MappedDataSource       |\n               |                    |                        |\n               |                    |                        V\n               |                    |                    Transform response to format expected in the GraphQL Query\n               |                    |                        |\n               |                    |                        V\n              _|_                  _|_                   Return response\nIn graphql.js  |                                             |\n               |                                             V\n              _|_                                        Recursively visit and validate response\n")))}},ionY:function(e,n,t){"use strict";n.__esModule=!0;var o=t("ERkP"),a=(i(o),i(t("aWzz"))),r=i(t("BS/m"));i(t("/2Cm"));function i(e){return e&&e.__esModule?e:{default:e}}function s(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function p(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!==typeof n&&"function"!==typeof n?e:n}function c(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}var u=1073741823;n.default=function(e,n){var t,i,l="__create-react-context-"+(0,r.default)()+"__",m=function(e){function t(){var n,o;s(this,t);for(var a=arguments.length,r=Array(a),i=0;i<a;i++)r[i]=arguments[i];return n=o=p(this,e.call.apply(e,[this].concat(r))),o.emitter=function(e){var n=[];return{on:function(e){n.push(e)},off:function(e){n=n.filter((function(n){return n!==e}))},get:function(){return e},set:function(t,o){e=t,n.forEach((function(n){return n(e,o)}))}}}(o.props.value),p(o,n)}return c(t,e),t.prototype.getChildContext=function(){var e;return(e={})[l]=this.emitter,e},t.prototype.componentWillReceiveProps=function(e){if(this.props.value!==e.value){var t=this.props.value,o=e.value,a=void 0;((r=t)===(i=o)?0!==r||1/r===1/i:r!==r&&i!==i)?a=0:(a="function"===typeof n?n(t,o):u,0!==(a|=0)&&this.emitter.set(e.value,a))}var r,i},t.prototype.render=function(){return this.props.children},t}(o.Component);m.childContextTypes=((t={})[l]=a.default.object.isRequired,t);var d=function(n){function t(){var e,o;s(this,t);for(var a=arguments.length,r=Array(a),i=0;i<a;i++)r[i]=arguments[i];return e=o=p(this,n.call.apply(n,[this].concat(r))),o.state={value:o.getValue()},o.onUpdate=function(e,n){0!==((0|o.observedBits)&n)&&o.setState({value:o.getValue()})},p(o,e)}return c(t,n),t.prototype.componentWillReceiveProps=function(e){var n=e.observedBits;this.observedBits=void 0===n||null===n?u:n},t.prototype.componentDidMount=function(){this.context[l]&&this.context[l].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=void 0===e||null===e?u:e},t.prototype.componentWillUnmount=function(){this.context[l]&&this.context[l].off(this.onUpdate)},t.prototype.getValue=function(){return this.context[l]?this.context[l].get():e},t.prototype.render=function(){return(e=this.props.children,Array.isArray(e)?e[0]:e)(this.state.value);var e},t}(o.Component);return d.contextTypes=((i={})[l]=a.default.object,i),{Provider:m,Consumer:d}},e.exports=n.default},tBqf:function(e,n,t){"use strict";function o(e){return function(){return e}}var a=function(){};a.thatReturns=o,a.thatReturnsFalse=o(!1),a.thatReturnsTrue=o(!0),a.thatReturnsNull=o(null),a.thatReturnsThis=function(){return this},a.thatReturnsArgument=function(e){return e},e.exports=a},xfLP:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/architecture-overview",function(){return t("b8zT")}])},"yTr/":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t("UF1R");Object.defineProperty(n,"MDXTag",{enumerable:!0,get:function(){return r(o).default}});var a=t("7VEG");function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"MDXProvider",{enumerable:!0,get:function(){return r(a).default}})}},[["xfLP",1,0,3]]]);