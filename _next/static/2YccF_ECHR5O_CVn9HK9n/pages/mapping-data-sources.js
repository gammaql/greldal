(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{602:function(e,a,n){__NEXT_REGISTER_PAGE("/mapping-data-sources",function(){return e.exports=n(603),{page:e.exports.default}})},603:function(e,a,n){"use strict";n.r(a);var t=n(0),o=n.n(t),s=n(1),p=n(3);function r(e,a){if(null==e)return{};var n,t,o=function(e,a){if(null==e)return{};var n,t,o={},s=Object.keys(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||(o[n]=e[n]);return o}(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}a.default=function(e){var a=e.components;r(e,["components"]);return o.a.createElement(s.MDXTag,{name:"wrapper",components:a},o.a.createElement(s.MDXTag,{name:"h1",components:a,props:{id:"mapping-data-sources"}},o.a.createElement(s.MDXTag,{name:"a",components:a,parentName:"h1",props:{href:"#mapping-data-sources","aria-hidden":"true"}},o.a.createElement(s.MDXTag,{name:"span",components:a,parentName:"a",props:{className:"icon icon-link"}})),"Mapping Data Sources"),o.a.createElement(s.MDXTag,{name:"p",components:a},"Creation of a GraphQL API using GRelDAL essentially involves defining operations on data sources."),o.a.createElement(s.MDXTag,{name:"p",components:a},"Operations are what we expose to the outside world through GraphQL queries and mutations and these operations interact with the data stored in our databases through data sources. These data sources are usually backed by tables, but they can also be backed by views, materialized views, joined tables, etc."),o.a.createElement(s.MDXTag,{name:"p",components:a},"We can use the mapSource function to map a datasource:"),o.a.createElement(s.MDXTag,{name:"pre",components:a},o.a.createElement(s.MDXTag,{name:"code",components:a,parentName:"pre",props:{className:"hljs language-ts",metaString:""}},o.a.createElement(s.MDXTag,{name:"span",components:a,parentName:"code",props:{className:"hljs-keyword"}},"const")," users = mapDataSource({\n    name: ",o.a.createElement(s.MDXTag,{name:"span",components:a,parentName:"code",props:{className:"hljs-string"}},'"User"'),",\n    fields: {\n        id: {\n            ",o.a.createElement(s.MDXTag,{name:"span",components:a,parentName:"code",props:{className:"hljs-keyword"}},"type"),": types.number,\n            to: GraphQLID,\n        },\n        name: {\n            ",o.a.createElement(s.MDXTag,{name:"span",components:a,parentName:"code",props:{className:"hljs-keyword"}},"type"),": types.string,\n        },\n    },\n});")),o.a.createElement(s.MDXTag,{name:"p",components:a},"As we have already covered in the ",o.a.createElement(p.a,{href:"#quick-start"},"Quick Start")," the above configuration tells GRelDAL that we want to map the ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:a,parentName:"p"},"users")," table (pluralized from ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:a,parentName:"p"},"User"),") to a ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:a,parentName:"p"},"User")," data source, and this data source will have two fields: id, name."),o.a.createElement(s.MDXTag,{name:"p",components:a},"GRelDAL's focus on convention over configuration reduces quite a bit of boilerplate from what would otherwise have been a more verbose mapping:"),o.a.createElement(s.MDXTag,{name:"pre",components:a},o.a.createElement(s.MDXTag,{name:"code",components:a,parentName:"pre",props:{className:"hljs language-ts",metaString:""}},o.a.createElement(s.MDXTag,{name:"span",components:a,parentName:"code",props:{className:"hljs-keyword"}},"const")," users = mapDataSource({\n    name: {\n        mapped: ",o.a.createElement(s.MDXTag,{name:"span",components:a,parentName:"code",props:{className:"hljs-string"}},'"User"'),",\n        stored: ",o.a.createElement(s.MDXTag,{name:"span",components:a,parentName:"code",props:{className:"hljs-string"}},'"users"'),",\n    },\n    fields: {\n        id: {\n            sourceColumn: ",o.a.createElement(s.MDXTag,{name:"span",components:a,parentName:"code",props:{className:"hljs-string"}},'"id"'),",\n            ",o.a.createElement(s.MDXTag,{name:"span",components:a,parentName:"code",props:{className:"hljs-keyword"}},"type"),": types.string,\n            to: {\n                input: GraphQLID,\n                output: GraphQLID,\n            },\n        },\n        name: {\n            sourceColumn: ",o.a.createElement(s.MDXTag,{name:"span",components:a,parentName:"code",props:{className:"hljs-string"}},'"name"'),",\n            ",o.a.createElement(s.MDXTag,{name:"span",components:a,parentName:"code",props:{className:"hljs-keyword"}},"type"),": types.string,\n            to: {\n                input: GraphQLString,\n                output: GraphQLString,\n            },\n        },\n    },\n});")),o.a.createElement(s.MDXTag,{name:"h2",components:a,props:{id:"type-specifications"}},o.a.createElement(s.MDXTag,{name:"a",components:a,parentName:"h2",props:{href:"#type-specifications","aria-hidden":"true"}},o.a.createElement(s.MDXTag,{name:"span",components:a,parentName:"a",props:{className:"icon icon-link"}})),"Type specifications"),o.a.createElement(s.MDXTag,{name:"p",components:a},"Note that for every field we had to specify a type. This type was specified through what we call runtime-types. The section on ",o.a.createElement(p.a,null,"Type Safety"),"\ngoes into more on detail on this, but essentially for all primitives we have corresponding runtime types:"),o.a.createElement(s.MDXTag,{name:"p",components:a},"| string  | types.string  |\n| number  | types.number  |\n| boolean | types.boolean |"),o.a.createElement(s.MDXTag,{name:"p",components:a},"Some GraphQL types have no equivalent typescript type (eg. GraphQLInt, GraphQLID) and for them we can specifically mention the input and output types.\nIn case both are same (",o.a.createElement(s.MDXTag,{name:"inlineCode",components:a,parentName:"p"},"{to: {input: GraphQLID, output: GraphQLID}}"),") can can just specify them once (",o.a.createElement(s.MDXTag,{name:"inlineCode",components:a,parentName:"p"},"{to: GraphQLID}"),")."),o.a.createElement(s.MDXTag,{name:"p",components:a},"We can compose these types to build composite types:"),o.a.createElement(s.MDXTag,{name:"pre",components:a},o.a.createElement(s.MDXTag,{name:"code",components:a,parentName:"pre",props:{metaString:null}},"const addresses = types.array([\n    types.type({\n        street: types.string,\n        plot_no: types.number\n    })\n])\n")),o.a.createElement(s.MDXTag,{name:"p",components:a},"Refer to the documentation of io-ts (which we simply re-export as types) for more details around using and defining runtime types."),o.a.createElement(s.MDXTag,{name:"h2",components:a,props:{id:"computed-fields"}},o.a.createElement(s.MDXTag,{name:"a",components:a,parentName:"h2",props:{href:"#computed-fields","aria-hidden":"true"}},o.a.createElement(s.MDXTag,{name:"span",components:a,parentName:"a",props:{className:"icon icon-link"}})),"Computed fields"),o.a.createElement(s.MDXTag,{name:"p",components:a},"Fields don't necessarily have to map to columns one-to-one."),o.a.createElement(s.MDXTag,{name:"p",components:a},"We can have computed fields which depend on other column-based fields and are computed on the fly:"),o.a.createElement(s.MDXTag,{name:"pre",components:a},o.a.createElement(s.MDXTag,{name:"code",components:a,parentName:"pre",props:{metaString:null}},'fields: {\n    fullName: {\n        dependencies: ["firstName", "lastName"],\n        derive: (firstName, lastName) => `${firstName} ${lastName}`,\n        to: types.string\n    }\n}\n')),o.a.createElement(s.MDXTag,{name:"h2",components:a,props:{id:"associations"}},o.a.createElement(s.MDXTag,{name:"a",components:a,parentName:"h2",props:{href:"#associations","aria-hidden":"true"}},o.a.createElement(s.MDXTag,{name:"span",components:a,parentName:"a",props:{className:"icon icon-link"}})),"Associations"),o.a.createElement(s.MDXTag,{name:"p",components:a},"GRelDAL supports linking together data sources through associations and performing operations that span across multiple data sources."),o.a.createElement(s.MDXTag,{name:"p",components:a},"The section on ",o.a.createElement(p.a,null,"association mapping")," will cover this in more detail."),o.a.createElement(p.b,null,"Mapping Operations"))}}},[[602,1,0]]]);