<!DOCTYPE html><html lang="id"><head><meta charSet="utf-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><link rel="apple-touch-icon" sizes="57x57" href="/greldal/static/favicons/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/greldal/static/favicons/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/greldal/static/favicons/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/greldal/static/favicons/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/greldal/static/favicons/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/greldal/static/favicons/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/greldal/static/favicons/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/greldal/static/favicons/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/greldal/static/favicons/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/greldal/static/favicons/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/greldal/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/greldal/static/favicons/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/greldal/static/favicons/favicon-16x16.png"/><meta name="msapplication-TileColor" content="#E535AB"/><meta name="msapplication-TileImage" content="/greldal/static/favicons/ms-icon-144x144.png"/><meta name="theme-color" content="#E535AB"/><style data-styled="hFdWyr dRinVF jIsvFx fqzCbS cpbcGU fbiqeh erfeuD jRqOow" data-styled-version="4.1.3">
/* sc-component-id: Link__Anchor-sc-1hbrjrd-0 */
.jIsvFx{cursor:pointer;background:black;padding:5px;text-transform:uppercase;border-radius:4px;margin:1.6rem 0;color:white !important;}.fqzCbS{cursor:pointer;}
/* sc-component-id: Link__TrailingIcon-sc-1hbrjrd-1 */
.cpbcGU{margin-right:5px;float:right;}
/* sc-component-id: sc-htpNat */
.dRinVF{font-size:0.8rem;font-weight:100;color:orange;background:lemonchiffon;padding:4px;border-radius:4px;border:1px solid orange;position:relative;top:-20px;}
/* sc-component-id: Sidebar__FixedSidebarContainer-sc-1bydltt-1 */
.hFdWyr{background:#fff;padding:10px 30px 30px 30px;position:fixed;top:0;left:0;bottom:0;width:300px;overflow-y:auto;overflow-x:auto;border-right:1px solid #bbb;box-shadow:0 0 20px #ccc;} .hFdWyr a,.hFdWyr a:visited{display:block;color:#000;font-weight:700;margin-top:5px;-webkit-text-decoration:none;text-decoration:none;} .hFdWyr h1,.hFdWyr h2,.hFdWyr h3,.hFdWyr h4,.hFdWyr h5,.hFdWyr h6{font-size:0.75rem !important;font-weight:600;}
/* sc-component-id: Sidebar__SectionHeader-sc-1bydltt-2 */
.erfeuD{background:#ddd;padding:5px 10px;text-transform:uppercase;border-radius:4px;color:gray;font-size:0.75rem;margin:1.6rem 0;}
/* sc-component-id: Sidebar__Bolt-sc-1bydltt-3 */
.fbiqeh{margin-right:5px;}
/* sc-component-id: PageLayout__DesktopContentContainer-ct4rbe-6 */
.jRqOow{max-width:700px;margin:40px 100px 50px 400px;} .jRqOow pre{padding:0 !important;} .jRqOow h1{margin:3rem 0;} .jRqOow h2,.jRqOow h3,.jRqOow h4,.jRqOow h5,.jRqOow h6{margin:2rem 0;} .jRqOow p,.jRqOow ol,.jRqOow ul{margin:2rem 0;} .jRqOow pre > code{border-left:4px solid #ddd;display:block;margin:0;padding:5px;} .jRqOow pre{max-width:calc(100% - 40px);overflow-x:auto;border:1px solid #ddd;background:#f8f8f8;} .jRqOow a,.jRqOow a:visited,.jRqOow a:hover,.jRqOow a:active{color:#0261cd;font-weight:bold;-webkit-text-decoration:none;text-decoration:none;}</style><meta charSet="utf-8" class="next-head"/><link rel="preload" href="/greldal/_next/static/~zrvxL_use9O2VxGJyrgJ/pages/architecture-overview.js" as="script"/><link rel="preload" href="/greldal/_next/static/~zrvxL_use9O2VxGJyrgJ/pages/_app.js" as="script"/><link rel="preload" href="/greldal/_next/static/runtime/webpack-2a7a0f0e8092aec5eb6f.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/commons.f6797a1a24b44de8f81f.js" as="script"/><link rel="preload" href="/greldal/_next/static/runtime/main-2d47b5361aef32ed1165.js" as="script"/><link rel="preload" href="/greldal/_next/static/chunks/styles.ac071f49e3c32efa6076.js" as="script"/><link rel="stylesheet" href="/greldal/_next/static/css/styles.26d0dfba.chunk.css"/></head><body class="custom_class"><div id="__next"><div style="display:none"><div class="Sidebar__SidebarContainer-sc-1bydltt-0 Sidebar__FixedSidebarContainer-sc-1bydltt-1 hFdWyr"><div style="padding-bottom:10px;display:flex;flex-direction:row;cursor:pointer"><img src="/greldal/_next/static/images/81342499647d5509de6dd828ff74969e.png" style="height:50px;width:50px"/><div style="font-weight:600;font-size:2rem;line-height:50px;padding-left:10px;color:#e535ab">GRelDAL<span class="sc-htpNat dRinVF">Beta</span></div></div><a class="Link__Anchor-sc-1hbrjrd-0 jIsvFx"><div class="Link__TrailingIcon-sc-1hbrjrd-1 cpbcGU">⯈</div>API</a><a class="Link__Anchor-sc-1hbrjrd-0 fqzCbS"><span class="Sidebar__Bolt-sc-1bydltt-3 fbiqeh">⚡</span>Quick Start</a><a class="Link__Anchor-sc-1hbrjrd-0 fqzCbS"><span class="Sidebar__Bolt-sc-1bydltt-3 fbiqeh">⚡</span>Frequently Asked Questions</a><a class="Link__Anchor-sc-1hbrjrd-0 fqzCbS"><h1 class="Sidebar__SectionHeader-sc-1bydltt-2 erfeuD">Guides</h1></a><a class="Link__Anchor-sc-1hbrjrd-0 fqzCbS"><span class="Sidebar__Bolt-sc-1bydltt-3 fbiqeh">⚡</span>Mapping Data Sources</a><a class="Link__Anchor-sc-1hbrjrd-0 fqzCbS"><span class="Sidebar__Bolt-sc-1bydltt-3 fbiqeh">⚡</span>Mapping Operations</a><a class="Link__Anchor-sc-1hbrjrd-0 fqzCbS"><span class="Sidebar__Bolt-sc-1bydltt-3 fbiqeh">⚡</span>Mapping Associations</a><a class="Link__Anchor-sc-1hbrjrd-0 fqzCbS"><span class="Sidebar__Bolt-sc-1bydltt-3 fbiqeh">⚡</span>Best Practices</a><h1 class="Sidebar__SectionHeader-sc-1bydltt-2 erfeuD">Additional Topics</h1><a class="Link__Anchor-sc-1hbrjrd-0 fqzCbS"><span class="Sidebar__Bolt-sc-1bydltt-3 fbiqeh">⚡</span>Type Safety</a><a class="Link__Anchor-sc-1hbrjrd-0 fqzCbS"><span class="Sidebar__Bolt-sc-1bydltt-3 fbiqeh">⚡</span>Architecture</a><a class="Link__Anchor-sc-1hbrjrd-0 fqzCbS"><span class="Sidebar__Bolt-sc-1bydltt-3 fbiqeh">⚡</span>Comparision With Alternatives</a></div><div id="container" class="PageLayout__ContentContainer-ct4rbe-5 PageLayout__DesktopContentContainer-ct4rbe-6 jRqOow"><div><p>⚠️ This document is not an introduction for beginners. If you are new to GRelDAL it is strongly recommended that you first go through the guides and the bugbox tutorial.</p><h1 id="architecture-overview"><a href="#architecture-overview" aria-hidden="true"><span class="icon icon-link"></span></a>Architecture Overview</h1><p>There are four primary concepts around which GRelDAL is built:</p><ol><li>Mapped Data Sources</li><li>Mapped Operations</li><li>Operation Resolvers</li><li>Operation Presets</li></ol><h2 id="mapped-data-sources"><a href="#mapped-data-sources" aria-hidden="true"><span class="icon icon-link"></span></a>Mapped data sources</h2><p>Mapped data sources represent a source in a relational database (usually a table, or a view, sometimes a joined table) which can serve as our primary source of truth.</p><p>It is the responsibility of a <code>MappedDataSource</code> instance to talk to the data source it represents. In many cases the actual data structure we expose to the application layer (referred here as Entities) differs from the table schema of the data source and in these cases it is the responsibility of the mapped data source to transparently convert between these representations and shield the application from having to know about the table schema.</p><p>Unlike ORMs, GRelDAL recommends usage of plain old javascript objects as entities.</p><p>A <code>MappedDataSource</code> instance can be constructed by calling the <code>mapDataSource</code> function, which accepts a mapping configuration.
This mapping configuration determines:</p><ol><li>How the columns (in the source) are mapped to fields (of the entity).</li><li>What other data sources this data source can be associated with, and how can these associations be loaded.</li></ol><p>Data sources can &quot;cooperate&quot; (by transforming a shared query builder) when the operation spans over multiple data sources - eg. when performing operations on join tables.</p><h2 id="mapped-operations"><a href="#mapped-operations" aria-hidden="true"><span class="icon icon-link"></span></a>Mapped Operations</h2><p>Operations generalize the concepts of Queries and mutations in GraphQL.</p><pre><code>Operation // Abstract interface for an operation mapSchema can handle (1)
   ^
   |
   |_ MappedOperation // Base class for GRelDAL aware operations
         ^
         |
         |_ MappedSingleSourceOperation    // Base class for operations that operates on a single primary source
         |     ^
         |     |_ MappedSingleSourceQueryOperation
         |     |_ MappedSingleSourceInsertionOperation
         |     |_ MappedSingleSourceUpdateOperation
         |     |_ MappedSingleSourceDeletionOperation
         |
         |_ MappedMultiSourceOperation    // Base class for operations that operate on multiple sources
               ^
               |_ MappedMultiSourceUnionQueryOperation
</code></pre><p>Operations delegate the actual resolution to an associated operation resolver. All the information that the resolver may need are encapsulated in the ResolverContext DTO which is instantiated by the Operation implementation. </p><h2 id="operation-resolvers"><a href="#operation-resolvers" aria-hidden="true"><span class="icon icon-link"></span></a>Operation Resolvers</h2><p>Operation resolvers implement the actual logic for resolving the operations. All the <code>MappedOperation</code> implementations defined by GRelDAL are associated with corresponding default resolvers, however they can be overriden through operation mapping configuration.</p><pre><code>Operation                                                                                                      OperationResolver
   ^                                                                                                                          ^
   |                                                                                                                          |
   |_ MappedOperation                                                                          SourceAwareOperationResolver___|
         ^                                                                                                         ^
         |                                                                                                         |
         |_ MappedSingleSourceOperation                                                                            |
         |     ^                                                                                                   |
         |     |_ MappedSingleSourceQueryOperation ------ (defaults to)-&gt;     SingleSourceQueryOperationResolver __|
         |     |_ MappedSingleSourceInsertionOperation -- (defaults to)-&gt; SingleSourceInsertionOperationResolver __|
         |     |_ MappedSingleSourceUpdateOperation ----- (defaults to)-&gt;    SingleSourceUpdateOperationResolver __|
         |     |_ MappedSingleSourceDeletionOperation --- (defaults to)-&gt;  SingleSourceDeletionOperationResolver __|
         |                                                                                                         |
         |_ MappedMultiSourceOperation                                                                             |
               ^                                                                                                   |
               |_ MappedMultiSourceUnionQueryOperation -- (defaults to)-&gt; MultiSourceUnionQueryOperationResolver __|
</code></pre><p>Query resolvers can also &quot;delegate&quot; through &quot;side-loading&quot; - this is a better alternative to hierarchical resolution in GraphQL that often results in N+1 query patterns because side-loading supports batch resolution and resolved results are automatically mapped and associated to parent entities.</p><h2 id="operation-presets"><a href="#operation-presets" aria-hidden="true"><span class="icon icon-link"></span></a>Operation Presets</h2><p>Operation presets are pre-configured operation for common use cases (CRUD operations).</p><p>Despite being pre-configured presets afford a great deal of flexibility because it accomodates custom transformation of mapping through interceptors.</p><h1 id="operation-resolution-process"><a href="#operation-resolution-process" aria-hidden="true"><span class="icon icon-link"></span></a>Operation resolution process</h1><p>GRelDAL is designed to work with graphql.js - the reference implementation of GraphQL provided by facebook.</p><p><code>mapSchema</code> function constructs a graphql.js compatible schema from a collection of GRelDAL operations. Every operation has a fieldConfig getter that returns a graphql.js compatible fieldConfig. Application can associate interceptors for the fieldConfig which can transform how an operation is mapped to a query/mutation field.</p><p>Most of the GraphQL types are derived from the DataSource mapping configuration.</p><p>Resolution of a typical GraphQL Query looks something like this:</p><pre><code>              ___
               |                                         Parsing of GraphQL DSL
               |                                             |
               |                                             |
In graphql.js -|                                             V
               |                                         Identify fieldConfig using query/mutation name
               |                                             |
               |                                             V
               |                                         Invoke fieldConfig.resolve
               |                                             |
              _|_                  ___                       V
               |                    |                    Initialize ResolverContext (1)
               |                    |                        |
               |                    |                        V
               |                    |                    Locate OperationResolver implementation
               |                 In |                        |
               |    MappedOperation |                        V
               |                    |                    Initialize OperationResolver with resolverContext
               |                    |                        |
               |                    |                        V
               |                   -+-                   Invoke OperationResolver#resolve
               |                    |                        |
               |                    |                        V
               |                    |                    Invoke dataSource methods to construct SQL query
           In  |                In  |                        |
      GRelDAL  | OperationResolver  |_                       V
               |                    |                    Invoke Knex to construct SQL query
               |                    |                        |
               |                    |                        V
               |                    | In                 Use configured data source connector to run SQL
               |                    | MappedDataSource       |
               |                    |                        |
               |                    |                        V
               |                    |                    Transform response to format expected in the GraphQL Query
               |                    |                        |
               |                    |                        V
              _|_                  _|_                   Return response
In graphql.js  |                                             |
               |                                             V
              _|_                                        Recursively visit and validate response
</code></pre></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/architecture-overview","query":{},"buildId":"~zrvxL_use9O2VxGJyrgJ","nextExport":true}</script><script async="" id="__NEXT_PAGE__/architecture-overview" src="/greldal/_next/static/~zrvxL_use9O2VxGJyrgJ/pages/architecture-overview.js"></script><script async="" id="__NEXT_PAGE__/_app" src="/greldal/_next/static/~zrvxL_use9O2VxGJyrgJ/pages/_app.js"></script><script src="/greldal/_next/static/runtime/webpack-2a7a0f0e8092aec5eb6f.js" async=""></script><script src="/greldal/_next/static/chunks/commons.f6797a1a24b44de8f81f.js" async=""></script><script src="/greldal/_next/static/runtime/main-2d47b5361aef32ed1165.js" async=""></script><script src="/greldal/_next/static/chunks/styles.ac071f49e3c32efa6076.js" async=""></script></body></html>